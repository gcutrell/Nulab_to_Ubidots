<scripts>
  
	<script name="SetMacroRunTimes" > <!--  Macro version 2.0 for 2mm dtectors; time in seconds -->
		<set vars="NO3mac1rt,NO3mac2rt,NO3mac3rt,NO3mac4rt,NO3mac5rt,NO3mac6rt,NO3mac7rt,NO3mac8rt" values="780,780,120,600,60,120,480,480" />
		<set vars="PO4mac1rt,PO4mac2rt,PO4mac3rt,PO4mac4rt,PO4mac5rt,PO4mac6rt" values="900,900,120,600,60,120" />
		<set vars="NH4mac1rt,NH4mac2rt,NH4mac3rt,NH4mac4rt,NH4mac5rt,NH4mac6rt" values="1080,1080,120,600,60,120" /> <!-- time in seconds -->
	</script>

	<script name="CheckNO3MacroRunTimes" >
		<switch  var="Macro" >
			<case value="M1" >
				<if condition="[Interval] LT [NO3mac1rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NO3 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M2" >
				<if condition="[Interval] LT [NO3mac2rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NO3 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M3" >
				<if condition="[Interval] LT [NO3mac3rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NO3 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M4" >
				<if condition="[Interval] LT [NO3mac4rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NO3 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M5" >
				<if condition="[Interval] LT [NO3mac5rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NO3 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M6" >
				<if condition="[Interval] LT [NO3mac6rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NO3 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M7" >
				<if condition="[Interval] LT [NO3mac7rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NO3 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M8" >
				<if condition="[Interval] LT [NO3mac8rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NO3 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<default >
				<set var="SysMessage" value="NO3 channel Interval check passed" />
				<run script="WriteOutput" />
			</default>
		</switch>
		<pause seconds="3" />
	</script>

	<script name="CheckPO4MacroRunTimes" >
		<switch  var="Macro" >
			<case value="M1" >
				<if condition="[Interval] LT [PO4mac1rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run PO4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M2" >
				<if condition="[Interval] LT [PO4mac2rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run PO4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M3" >
				<if condition="[Interval] LT [PO4mac3rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run PO4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M4" >
				<if condition="[Interval] LT [PO4mac4rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run PO4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M5" >
				<if condition="[Interval] LT [PO4mac5rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run PO4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M6" >
				<if condition="[Interval] LT [PO4mac6rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run PO4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<default >
				<set var="SysMessage" value="PO4 channel Interval check passed" />
				<run script="WriteOutput" />
			</default>
		</switch>
		<pause seconds="3" />
	</script>

		<script name="CheckNH4MacroRunTimes" >
		<switch  var="Macro" >
			<case value="M1" >
				<if condition="[Interval] LT [NH4mac1rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NH4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M2" >
				<if condition="[Interval] LT [NH4mac2rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NH4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M3" >
				<if condition="[Interval] LT [NH4mac3rt]" >
					<set var="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NH4 channel macro [Macro]" />
					<run script="WriteOutput" />
			</if>
			</case>
			<case value="M4" >
				<if condition="[Interval] LT [NH4mac4rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NH4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<case value="M5" >
				<if condition="[Interval] LT [NH4mac5rt]" >
				<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
						<set var="SysMessage" value="Error: Interval not long enough to run NH4 channel macro [Macro]" />
						<run script="WriteOutput" />
				</if>
			</case>
			<case value="M6" >
				<if condition="[Interval] LT [NH4mac6rt]" >
					<set vars="NO3mac,PO4mac,NH4mac" value="0,0,0" />
					<set var="SysMessage" value="Error: Interval not long enough to run NH4 channel macro [Macro]" />
					<run script="WriteOutput" />
				</if>
			</case>
			<default >
				<set var="SysMessage" value="NH4 channel Interval check passed" />
				<run script="WriteOutput" />
			</default>
		</switch>
		<pause seconds="3" />
	</script>

</scripts>
